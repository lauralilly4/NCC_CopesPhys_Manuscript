y = -0.9, size = 4, colour = "black") +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank())
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/PX1_nMDS_LoadsTimeser.png", plot = pltx1a, width = 2000, height = 1000, units = 'px')
pltx2a <- ggplot(mstrdayall, aes(x = Samp_Date, y = NMDS2)) +
geom_point(aes(x = Samp_Date, y = NMDS2), size = 0.7, color = 'grey40') +
geom_smooth(method = "lm")
pltx2a
summary(lm2)
# 4.2: NMDS2
pltx2a <- ggplot(mstrdayall, aes(x = Samp_Date, y = NMDS2)) +
geom_point(aes(x = Samp_Date, y = NMDS2), size = 0.7, color = 'grey40') +
geom_smooth(method = "lm") +
annotate("text", label = "Adj. R^2 = 0.03", x = mstrdayall$Samp_Date[9000],
y = 0.7, size = 4, colour = "black") +
annotate("text", label = "p < 0.001", x = mstrdayall$Samp_Date[9000],
y = 0.6, size = 4, colour = "black") +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank())
pltx2a
# 4.2: NMDS2
pltx2a <- ggplot(mstrdayall, aes(x = Samp_Date, y = NMDS2)) +
geom_point(aes(x = Samp_Date, y = NMDS2), size = 0.7, color = 'grey40') +
geom_smooth(method = "lm") +
annotate("text", label = "Adj. R^2 = 0.03", x = mstrdayall$Samp_Date[8600],
y = 0.7, size = 4, colour = "black") +
annotate("text", label = "p < 0.001", x = mstrdayall$Samp_Date[8600],
y = 0.6, size = 4, colour = "black") +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank())
pltx2a
# 4.2: NMDS2
pltx2a <- ggplot(mstrdayall, aes(x = Samp_Date, y = NMDS2)) +
geom_point(aes(x = Samp_Date, y = NMDS2), size = 0.7, color = 'grey40') +
geom_smooth(method = "lm") +
annotate("text", label = "Adj. R^2 = 0.03", x = mstrdayall$Samp_Date[8200],
y = 0.7, size = 4, colour = "black") +
annotate("text", label = "p < 0.001", x = mstrdayall$Samp_Date[8200],
y = 0.6, size = 4, colour = "black") +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank())
# 4.2: NMDS2
pltx2a <- ggplot(mstrdayall, aes(x = Samp_Date, y = NMDS2)) +
geom_point(aes(x = Samp_Date, y = NMDS2), size = 0.7, color = 'grey40') +
geom_smooth(method = "lm") +
annotate("text", label = "Adj. R^2 = 0.03", x = mstrdayall$Samp_Date[8200],
y = 0.7, size = 4, colour = "black") +
annotate("text", label = "p < 0.001", x = mstrdayall$Samp_Date[8200],
y = 0.6, size = 4, colour = "black") +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank())
pltx2a
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/PX1_nMDS2_LoadsTimeser.png", plot = pltx2a, width = 2000, height = 1000, units = 'px')
# PLOT 1 - NMDS1
plt02_1 <- ggplot(data = model_gm1, aes(x = DOY, y = fit)) +  # For some reason, have to plot the GAM first...
geom_smooth_ci(linetype = 'dashed', lwd = 1) +
geom_point(data = mstrdts_tib, aes(x = DOY, y = NMDS1, color = factor(pltyr), shape = factor(pltyr))) +
ylim(c(-1.5,1.5)) +
scale_color_manual(name = 'Year',
labels = yrsplt,
values = colsall) +
scale_shape_manual(name = 'Year',
labels = yrsplt,
values = symsall) +
scale_x_continuous(breaks = mstrdts_tib |>
group_by(month(Samp_Date)) |>
summarize(ndays = min(DOY)) |>
slice(c(1:12)) |>
pull(ndays),
labels = month.abb[c(1:12)]
) +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank()) +
guides(color = guide_legend(ncol = 7),
shape = guide_legend(ncol = 7))
plt02_1
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/P2_nMDS1_YrlyCyc.png", plot = plt02_1, width = 2000, height = 1600, units = 'px')
# PLOT 2 - NMDS2
plt02_2 <- ggplot(data = model_gm2, aes(x = DOY, y = fit)) +  # For some reason, have to plot the GAM first...
geom_smooth_ci(linetype = 'dashed', lwd = 1) +
geom_point(data = mstrdts_tib, aes(x = DOY, y = NMDS2, color = factor(pltyr), shape = factor(pltyr))) +
ylim(c(-1.5,1.5)) +
scale_color_manual(name = 'Year',
labels = yrsplt,
values = colsall) +
scale_shape_manual(name = 'Year',
labels = yrsplt,
values = symsall) +
scale_x_continuous(breaks = mstrdts_tib |>
group_by(month(Samp_Date)) |>
summarize(ndays = min(DOY)) |>
slice(c(1:12)) |>
pull(ndays),
labels = month.abb[c(1:12)]) +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
# legend.position = "none",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank()) +
guides(color = guide_legend(ncol = 7),
shape = guide_legend(ncol = 7))
plt02_2
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/P2_nMDS2_YrlyCyc.png", plot = plt02_2, width = 2000, height = 1600, units = 'px')
# PLOT 2 - NMDS2
plt02_2 <- ggplot(data = model_gm2, aes(x = DOY, y = fit)) +  # For some reason, have to plot the GAM first...
geom_smooth_ci(linetype = 'dashed', lwd = 1) +
geom_point(data = mstrdts_tib, aes(x = DOY, y = NMDS2, color = factor(pltyr), shape = factor(pltyr))) +
ylim(c(-1.5,1.5)) +
scale_color_manual(name = 'Year',
labels = yrsplt,
values = colsall) +
scale_shape_manual(name = 'Year',
labels = yrsplt,
values = symsall) +
scale_x_continuous(breaks = mstrdts_tib |>
group_by(month(Samp_Date)) |>
summarize(ndays = min(DOY)) |>
slice(c(1:12)) |>
pull(ndays),
labels = month.abb[c(1:12)]) +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
# legend.position = "bottom",
legend.position = "none",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank()) +
guides(color = guide_legend(ncol = 7),
shape = guide_legend(ncol = 7))
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/P2_nMDS2_YrlyCyc_noLgd.png", plot = plt02_2, width = 2000, height = 1200, units = 'px')
# PLOT 1 - NMDS1
plt02_1 <- ggplot(data = model_gm1, aes(x = DOY, y = fit)) +  # For some reason, have to plot the GAM first...
geom_smooth_ci(linetype = 'dashed', lwd = 1) +
geom_point(data = mstrdts_tib, aes(x = DOY, y = NMDS1, color = factor(pltyr), shape = factor(pltyr))) +
ylim(c(-1.1,1.1)) +
scale_color_manual(name = 'Year',
labels = yrsplt,
values = colsall) +
scale_shape_manual(name = 'Year',
labels = yrsplt,
values = symsall) +
scale_x_continuous(breaks = mstrdts_tib |>
group_by(month(Samp_Date)) |>
summarize(ndays = min(DOY)) |>
slice(c(1:12)) |>
pull(ndays),
labels = month.abb[c(1:12)]) +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank()) +
guides(color = guide_legend(ncol = 7),
shape = guide_legend(ncol = 7))
plt02_1
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/P2_nMDS1_YrlyCyc.png", plot = plt02_1, width = 2000, height = 1600, units = 'px')
# PLOT 2 - NMDS2
plt02_2 <- ggplot(data = model_gm2, aes(x = DOY, y = fit)) +  # For some reason, have to plot the GAM first...
geom_smooth_ci(linetype = 'dashed', lwd = 1) +
geom_point(data = mstrdts_tib, aes(x = DOY, y = NMDS2, color = factor(pltyr), shape = factor(pltyr))) +
ylim(c(-1.1,1.1)) +
scale_color_manual(name = 'Year',
labels = yrsplt,
values = colsall) +
scale_shape_manual(name = 'Year',
labels = yrsplt,
values = symsall) +
scale_x_continuous(breaks = mstrdts_tib |>
group_by(month(Samp_Date)) |>
summarize(ndays = min(DOY)) |>
slice(c(1:12)) |>
pull(ndays),
labels = month.abb[c(1:12)]) +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
# legend.position = "bottom",
legend.position = "none",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank()) +
guides(color = guide_legend(ncol = 7),
shape = guide_legend(ncol = 7))
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/P2_nMDS2_YrlyCyc_noLgd.png", plot = plt02_2, width = 2000, height = 1200, units = 'px')
# PLOT 2 - NMDS2
plt02_2 <- ggplot(data = model_gm2, aes(x = DOY, y = fit)) +  # For some reason, have to plot the GAM first...
geom_smooth_ci(linetype = 'dashed', lwd = 1) +
geom_point(data = mstrdts_tib, aes(x = DOY, y = NMDS2, color = factor(pltyr), shape = factor(pltyr))) +
ylim(c(-1.1,1.1)) +
scale_color_manual(name = 'Year',
labels = yrsplt,
values = colsall) +
scale_shape_manual(name = 'Year',
labels = yrsplt,
values = symsall) +
scale_x_continuous(breaks = mstrdts_tib |>
group_by(month(Samp_Date)) |>
summarize(ndays = min(DOY)) |>
slice(c(1:12)) |>
pull(ndays),
labels = month.abb[c(1:12)]) +
theme(axis.text = element_text(colour = "black", size = 12),
legend.text = element_text(size = 12, colour ="black"),
legend.position = "bottom",
# legend.position = "none",
axis.title = element_text(size = 14, colour = "black"),
legend.title = element_text(size = 14, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 0.5),
legend.key=element_blank()) +
guides(color = guide_legend(ncol = 7),
shape = guide_legend(ncol = 7))
ggsave("../../../OSU_NOAA_postdoc/Project1_SeasonalUpwelling/Plots_v4/P2_nMDS2_YrlyCyc.png", plot = plt02_2, width = 2000, height = 1600, units = 'px')
########## Data In ##########
flws_fl <- read.csv('NH10_Flows_Inst_Cumu.csv')
head(flws_fl)
########## Data In ##########
flwsfl <- read.csv('NH10_Flows_Inst_Cumu.csv')
########## Reshape DFs #########
inst_flw <- flwsfl[,1:2]
cumu_flw <- cbind(flwsfl[,1], flwsfl[,3])
flws_data <- flwsfl |>
mutate(Year = year(Date),
.after = Date)
library(tidyverse)
########## Data In ##########
flwsfl <- read.csv('NH10_Flows_Inst_Cumu.csv')
flws_data <- flwsfl |>
mutate(Year = year(Date),
.after = Date)
library(lubridate)
flws_data <- flwsfl |>
mutate(Year = year(Date),
.after = Date)
flws_data <- flwsfl |>
mutate(Date = as.Date(Date, format = "%d-%m-%Y"))
flws_data
flwsfl$Date
class(flwsfl$Date)
as.Date(flwsfl$Date[1],"%d-%m-%Y" )
as.Date(flwsfl$Date[1],"%Y-%m-%d")
as.Date(flwsfl$Date[1])
as.Date(flwsfl$Date[1],"%d-%M-%Y")
as.Date(flwsfl$Date[1],"%d-%b-%Y")
flws_data <- flwsfl |>
mutate(Date = as.Date(Date, format = "%d-%b-%Y"),
Year = year(Date),
.after = Date)
head(flws_data)
inst_flw <- flws_data |>
select(Date,Year,Inst_flow)
cumu_flw <- flws_data |>
select(Date,Year,Cumu_flow)
# Plot 1: Instantaneous flow - year-chunks
plt1 <- ggplot(data = inst_flw, aes(x = Date, y = inst_flow, group = Year)) +
geom_line(aes(color = Year, group = Year))
plt1
head(inst_flw)
# Plot 1: Instantaneous flow - year-chunks
plt1 <- ggplot(data = inst_flw, aes(x = Date, y = Inst_flow, group = Year)) +
geom_line(aes(color = Year, group = Year))
plt1
# Plot 1: Instantaneous flow - year-chunks
plt1 <- ggplot(data = inst_flw, aes(x = Date, y = Inst_flow)) +
geom_line(aes(color = Year, group = Year))
plt1
library(reshape2)
head(inst_flw)
# ### Plot 1: Instantaneous flow - year-chunks
# First, melt DF to see if that helps with plotting (even though it's already in shape)
inst_mlt <- melt(inst_flw, id = "Date")
head(inst_mlt)
# ### Plot 1: Instantaneous flow - year-chunks
# First, melt DF to see if that helps with plotting (even though it's already in shape)
inst_mlt <- melt(inst_flw, id = "Year")
# ### Plot 1: Instantaneous flow - year-chunks
# First, melt DF to see if that helps with plotting (even though it's already in shape)
colnames(inst_flw) <- c("Date", "variable", "value")
head(inst_flw)
flws_data <- flwsfl |>
mutate_all(~ifelse(is.nan(.), NA, .)) |>
mutate(Date = as.Date(Date, format = "%d-%b-%Y"),
Year = year(Date),
.after = Date)
head(flws_data)
########## Reshape DFs #########
inst_flw <- flws_data |>
select(Date,Year,Inst_flow)
cumu_flw <- flws_data |>
select(Date,Year,Cumu_flow)
# ### Plot 1: Instantaneous flow - year-chunks
# First, melt DF to see if that helps with plotting (even though it's already in shape)
colnames(inst_flw) <- c("Date", "variable", "value")
plt1 <- ggplot(data = inst_flw, aes(x = Date, y = Inst_flow)) +
geom_line(aes(color = Year, group = Year))
plt1
plt1 <- ggplot(data = inst_flw, aes(x = Date, y = value)) +
geom_line(aes(color = variable, group = variable))
plt1
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d")) |>
select(dt_mody,Year,Inst_flow)
head(inst_flw)
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Year)) +
geom_line(aes(color = Year, group = Year))
plt1
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Inst_flow)) +
geom_line(aes(color = Year, group = Year))
plt1
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Inst_flow)) +
geom_line(aes(color = Year, group = Year)) +
geom_segment(aes(x = dt_mody[1], xend = dt_mody[length(dt_mody)],
y = 0, yend = 0), color = "black", lwd = 1)
plt1
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Inst_flow)) +
geom_line(aes(color = factor(Year), group = Year)) +
geom_segment(aes(x = dt_mody[1], xend = dt_mody[length(dt_mody)],
y = 0, yend = 0), color = "black", lwd = 1) +
ylab("Flow (m/s)") +
xlab("Date")
scale_x_date(date_labels = "%b", date_breaks = "1 month")
plt1
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Inst_flow)) +
geom_line(aes(color = factor(Year), group = Year)) +
geom_segment(aes(x = dt_mody[1], xend = dt_mody[length(dt_mody)],
y = 0, yend = 0), color = "black", lwd = 1) +
ylab("Flow (m/s)") +
xlab("Date") +
scale_x_date(date_labels = "%b", date_breaks = "1 month")
plt1
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d"))
head(inst_flw)
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d")) |>
select(Date,dt_mody,Year,Inst_flow)
dim(inst_flw)
9131class(inst_flw$dt_mody)
class(inst_flw$dt_mody)
# ### Plot 1: Instantaneous flow - year-chunks
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Inst_flow)) +
geom_line(aes(color = factor(Year), group = Year)) +
geom_segment(aes(x = dt_mody[1], xend = dt_mody[length(dt_mody)],
y = 0, yend = 0), color = "black", lwd = 1) +
ylab("Flow (m/s)") +
xlab("Date")
plt1
library(tidyverse)
library(lubridate)
library(reshape2)
########## Data In ##########
flwsfl <- read.csv('NH10_Flows_Inst_Cumu.csv')
# Dataset cleanup and date conversion
flws_data <- flwsfl |>
mutate_all(~ifelse(is.nan(.), NA, .)) |>
mutate(Date = as.Date(Date, format = "%d-%b-%Y"),
Year = year(Date),
.after = Date)
########## Reshape DFs and get info #########
# ### DF #1: Instantaneous flow
# First, reconfigure dates
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d"),
plt_dt = seq.Date(as.Date("2000-01-01"),
as.Date("2000-12-31"),
by = "day")) |>
select(Date,dt_mody,Year,Inst_flow)
dim(flws_data)
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d"))
dim(inst_flws)
dim(inst_flw)
head(inst_flw)
lengh(unique(flws_data$Year))
length(unique(flws_data$Year))
9131/25
9131-6
9125/365
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d"),
# Will have to remove Leap Days if I want to add a repeat Date seq for plotting
# plt_dt = rep(seq.Date(as.Date("1999-01-01"),
#                  as.Date("1999-12-31"),
#                  by = "day")
) |>
select(Date,dt_mody,Year,Inst_flow)
head(inst_flw)
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d"),
# Will have to remove Leap Days if I want to add a repeat Date seq for plotting
# plt_dt = rep(seq.Date(as.Date("1999-01-01"),
#                  as.Date("1999-12-31"),
#                  by = "day")
) |>
select(dt_mody,Year,Inst_flow) |>
pivot_wider(names_from = Year, values_from = Inst_flow)
head(inst_flw)
########## Reshape DFs and get info #########
# ### DF #1: Instantaneous flow
# First, reconfigure dates
inst_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d"),
# Will have to remove Leap Days if I want to add a repeat Date seq for plotting
# plt_dt = rep(seq.Date(as.Date("1999-01-01"),
#                  as.Date("1999-12-31"),
#                  by = "day")
) |>
select(dt_mody,Year,Inst_flow)
inst_flw_yrly <- inst_flw |>
pivot_wider(names_from = Year, values_from = Inst_flow)
# ### DF #2: Cumulative flow
cumu_flw <- flws_data |>
select(Date,Year,Cumu_flow)
# ### Plot 1: Instantaneous flow - year-chunks
plt1 <- ggplot(data = inst_flw, aes(x = dt_mody, y = Inst_flow)) +
geom_line(aes(color = factor(Year), group = Year)) +
geom_segment(aes(x = dt_mody[1], xend = dt_mody[length(dt_mody)],
y = 0, yend = 0), color = "black", lwd = 1) +
ylab("Flow (m/s)") +
xlab("Date")
plt1
ncol(inst_flw_yrly)
i = 2
idx1 = find(inst_neg1[,i] <= 0)[1]
idx1 = find(inst_flw_yrly[,i] <= 0)
i
head(inst_flw_yrly)
inst_flw_yrly[,i]
find(inst_flw_yrly[,i] <= 0)
find(inst_flw_yrly[,i] <= 0, na.rm = TRUE)
class(inst_flw_yrly[,2])
class(inst_flw_yrly$`1997`)
which(inst_flw_yrly[,i] < 0)
inst_flw_yrly[224]
inst_flw_yrly[224,]
inst_flw_yrly[200:224,]
inst_neg1 <- data.frame(matrix(nrow = 1, ncol = ncol(inst_flw_yrly)-1))
for(i in 2:ncol(inst_flw_yrly)){
idx1 = which(inst_flw_yrly[,i] < 0)[1]
dt1 = inst_flw_yrly[1,i]
inst_neg1[1,i] <- dt1
}
inst_neg1
ncol(inst_flw_yrly)
inst_neg1 <- data.frame(matrix(nrow = 1, ncol = ncol(inst_flw_yrly)-1))
for(i in 2:ncol(inst_flw_yrly)){
idx1 = which(inst_flw_yrly[,i] < 0)[1]
dt1 = inst_flw_yrly[idx1,1]
inst_neg1[1,i-1] <- dt1
}
inst_neg1
colnames(inst_neg1) <- unique(inst_flw$Year)
inst_neg1
head(cumu_flw)
cumu_flw <- flws_data |>
mutate(dt_mody = format(Date, format = "%m-%d")) |>
select(dt_mody,Year,Cumu_flow)
# ### Plot 2: Instantaneous flow - year-chunks
plt2 <- ggplot(data = cumu_flw, aes(x = dt_mody, y = Cumu_flow)) +
geom_line(aes(color = factor(Year), group = Year)) +
geom_segment(aes(x = dt_mody[1], xend = dt_mody[length(dt_mody)],
y = 0, yend = 0), color = "black", lwd = 1) +
ylab("Flow (m/s)") +
xlab("Date")
plt2
inst_neg1
